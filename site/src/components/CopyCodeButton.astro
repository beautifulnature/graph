---
export interface Props {
  code: string;
}

const { code } = Astro.props;
---

<button
  class="copy-button absolute top-4 right-4 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded inline-flex items-center"
  data-code={code}
  title="Copy code to clipboard"
>
  <svg class="fill-current w-4 h-4 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
    <path d="M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"/>
  </svg>
  <slot />
</button>
<script>
  function copyCode(button: HTMLButtonElement) {
    const code = button.dataset.code;
    if(!code) return;
    navigator.clipboard.writeText(code);
    button.textContent = 'Copied!';
    setTimeout(() => {
      button.textContent = 'Copy Code';
    }, 2000);
  }
  const buttons = document.querySelectorAll<HTMLButtonElement>('button.copy-button');

  // Handle clicks on each button.
  buttons.forEach((button) => {
    button.addEventListener('click', () => {
        copyCode(button);
    });
  });
</script>
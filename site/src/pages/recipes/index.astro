---
import BaseHead from "../../components/BaseHead.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../../consts";
import { getCollection } from "astro:content";

const recipes = await getCollection("recipes");
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body>
    <Header />
    <main class="max-w-4xl mx-auto p-4 sm:px-6 lg:px-8 py-12">
      <section>
        <div>
          <h2 class="text-4xl font-bold mb-8">All Recipes</h2>
          <div class="space-y-8">
            {
              recipes.map((recipe) => (
                <a
                  class="flex bg-white shadow-md rounded-lg overflow-hidden transition-transform duration-300 ease-in-out hover:shadow-lg hover:transform"
                  href={`/recipes/${recipe.data.slug}`}
                >
                  <div class="flex-1 p-6">
                    <h4 class="text-xl font-bold text-gray-900 mb-2">
                      {recipe.data.metadata.title}
                    </h4>
                    <p class="text-gray-600 mb-4">
                      {recipe.data.metadata.description}
                    </p>
                    <div class="mb-4">
                      <p class="text-sm font-medium text-gray-700 mb-1">
                        Ingredients:
                      </p>
                      <p class="text-sm text-gray-500">
                        {[
                          ...new Set(
                            recipe.data.ingredients.map(
                              (ingredient) => ingredient.name
                            )
                          ),
                        ].join(", ")}
                      </p>
                    </div>
                    {recipe.data.cookwares.length > 0 && (
                      <div>
                        <p class="text-sm font-medium text-gray-700 mb-1">
                          Cookware:
                        </p>
                        <p class="text-sm text-gray-500">
                          {[
                            ...new Set(
                              recipe.data.cookwares.map((c) => c.name)
                            ),
                          ].join(", ")}
                        </p>
                      </div>
                    )}
                    {recipe.data.metadata?.tags && (
                      <div class="flex flex-wrap w-full items-center">
                        <p class="text-sm font-medium text-gray-700 mb-1 mr-2">
                          Tags:
                        </p>
                        {recipe.data.metadata.tags.map((tag) => (
                          <span class="inline-block bg-blue-100 text-blue-800 rounded-full px-3 py-1 text-sm mr-2 mb-2">
                            {tag.trim()}
                          </span>
                        ))}
                      </div>
                    )}
                  </div>
                </a>
              ))
            }
          </div>
        </div>
      </section>
    </main>
    <Footer />
  </body>
</html>
